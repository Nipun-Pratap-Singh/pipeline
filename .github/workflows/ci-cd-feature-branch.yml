name: CI for Feature Branches

on:
  push:
    branches:
      - frontend-1
      - frontend-2
      - backend-1
      - backend-2

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "20"

      - name: Install dependencies for frontend
        run: |
          cd client
          npm install

      - name: Install dependencies for backend
        run: |
          cd server
          npm install

      - name: Run tests for frontend
        run: |
          cd client
          npm test

      # - name: Run tests for backend
      #   run: |
      #     cd server
      #     npm test

      - name: Build frontend
        run: |
          cd client
          npm run build

      # - name: Merge feature branch into staging (If Tests Pass)
      #   run: |
      #     git config --global user.name "github-actions"
      #     git config --global user.email "actions@github.com"
      #     git fetch origin staging
      #     git checkout staging
      #     git merge ${{ github.head_ref }} --no-ff --allow-unrelated-histories -m "Auto-merge ${{ github.head_ref }} into staging"
      #     git push https://github-actions:${{ secrets.GH_TOKEN }}@github.com/${{ github.repository }} staging
      #   env:
      #     GH_TOKEN: ${{ secrets.GH_TOKEN }}

